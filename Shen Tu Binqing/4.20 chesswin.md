![](chesswin1.png)![chesswin1](https://user-images.githubusercontent.com/82360354/115357424-35650280-a1ef-11eb-8f55-0a4c86ffdf7e.png)
![](chesswin2.png)![chesswin2](https://user-images.githubusercontent.com/82360354/115357488-444bb500-a1ef-11eb-9337-b3d488e50874.png)


import numpy as np
import cv2
from os import system
import win32com.client
speaker = win32com.client.Dispatch("SAPI.SpVoice")
img=np.zeros((600,600,3),np.uint8)
img[:]=[200,5,100]
chess=np.zeros((3,3),np.int8)
cv2.line(img,(120,120),(480,120),(250,230,200),3)
cv2.line(img,(120,240),(480,240),(250,230,200),3)
cv2.line(img,(120,360),(480,360),(250,230,200),3)
cv2.line(img,(120,480),(480,480),(250,230,200),3)
cv2.line(img,(120,120),(120,480),(250,230,200),3)
cv2.line(img,(240,120),(240,480),(250,230,200),3)
cv2.line(img,(360,120),(360,480),(250,230,200),3)
cv2.line(img,(480,120),(480,480),(250,230,200),3)
a1 = 0
a2 = 0
a3 = 0
a4 = 0
a5 = 0
a6 = 0
a7 = 0
a8 = 0
a9 = 0
def oksan():
    global a1,a2,a3,a4,a5,a6,a7,a8,a9
    if a1==1 and a2==1 and a3==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a1==1 and a5==1 and a9==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a1==1 and a4==1 and a7==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a2==1 and a5==1 and a8==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a3==1 and a6==1 and a9==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a4==1 and a5==1 and a6==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2) 
    if a7==1 and a5==1 and a3==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a7==1 and a8==1 and a9==1:
        print("恭喜黑棋胜利")
        speaker.Speak("恭喜黑棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'Black win',(10,500), font, 4,(255,255,255),2)
    if a1==2 and a2==2 and a3==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
    if a1==2 and a5==2 and a9==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
    if a1==2 and a4==2 and a7==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
    if a2==2 and a5==2 and a8==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
    if a3==2 and a6==2 and a9==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
    if a4==2 and a5==2 and a6==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2) 
    if a7==2 and a5==2 and a3==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
    if a7==2 and a8==2 and a9==2:
        print("恭喜白棋胜利")
        speaker.Speak("恭喜白棋胜利")
        font=cv2.FONT_HERSHEY_SIMPLEX
        cv2.putText(img,'White win',(10,500), font, 4,(255,255,255),2)
def f_event(event,x,y,flag,param):
    global a1,a2,a3,a4,a5,a6,a7,a8,a9
    if flag == 1:
        if x>120 and x<240 and y>120 and y<240:
            a1 = 1      
            cv2.circle(img,(180,180), 50, (0,0,0), -1)
            oksan()
        elif x>240 and x<360 and y>120 and y<240:
            a2 = 1
            cv2.circle(img,(300,180), 50, (0,0,0), -1)
            oksan()
        elif x>360 and x<480 and y>120 and y<240:
            a3 = 1
            cv2.circle(img,(420,180), 50, (0,0,0), -1)
            oksan()
        elif x>120 and x<240 and y>240 and y<360:
            a4 = 1      
            cv2.circle(img,(180,300), 50, (0,0,0), -1)
            oksan()
        elif x>240 and x<360 and y>240 and y<360:
            a5 = 1
            cv2.circle(img,(300,300), 50, (0,0,0), -1)
            oksan()
        elif x>360 and x<480 and y>240 and y<360:
            a6 = 1
            cv2.circle(img,(420,300), 50, (0,0,0), -1)
            oksan()
        elif x>120 and x<240 and y>360 and y<480:
            a7 = 1      
            cv2.circle(img,(180,420), 50, (0,0,0), -1)
            oksan()
        elif x>240 and x<360 and y>360 and y<480:
            a8 = 1
            cv2.circle(img,(300,420), 50, (0,0,0), -1)
            oksan()
        elif x>360 and x<480 and y>360 and y<480:
            a9 = 1
            cv2.circle(img,(420,420), 50, (0,0,0), -1)
            oksan()
    elif flag == 2:
        if x>120 and x<240 and y>120 and y<240:
            a1 = 2      
            cv2.circle(img,(180,180), 50, (255,255,255), -1)
            oksan()       
        if x>240 and x<360 and y>120 and y<240:
            a2 = 2
            cv2.circle(img,(300,180), 50, (255,255,255), -1)
            oksan()
        if x>360 and x<480 and y>120 and y<240:
            a3 = 2
            cv2.circle(img,(420,180), 50, (255,255,255), -1)
            oksan()
        if x>120 and x<240 and y>240 and y<360:
            a4 = 2      
            cv2.circle(img,(180,300), 50, (255,255,255), -1)
            oksan()
        if x>240 and x<360 and y>240 and y<360:
            a5 = 2
            cv2.circle(img,(300,300), 50, (255,255,255), -1)
            oksan()
        if x>360 and x<480 and y>240 and y<360:
            a6 = 2
            cv2.circle(img,(420,300), 50, (255,255,255), -1)
            oksan()
        if x>120 and x<240 and y>360 and y<480: 
            a7 = 2     
            cv2.circle(img,(180,420), 50, (255,255,255), -1)
            oksan()
        if x>240 and x<360 and y>360 and y<480:
            a8 = 2
            cv2.circle(img,(300,420), 50, (255,255,255), -1)
            oksan()
        if x>360 and x<480 and y>360 and y<480:
            a9 = 2
            cv2.circle(img,(420,420), 50, (255,255,255), -1)
            oksan()
    if event==cv2.EVENT_LBUTTONDBLCLK:
        cv2.circle(img,(420,420), 50, (200,5,100), -1)

cv2.namedWindow("ABC")
cv2.setMouseCallback("ABC",f_event)

while True:
    cv2.waitKey(10)
    cv2.imshow("ABC",img)
